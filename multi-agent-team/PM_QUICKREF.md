# Multi-Agent Team Skill - PM 快速参考卡

## 暂停协议（核心）

```
发现问题 → 立即停止 → 收集上下文 → 详细汇报 → 等待决策 → 按方案恢复
```

## 4步暂停流程

### 1️⃣ 发送暂停信号
```python
sessions_send(
    sessionKey=agent_key,
    message="🛑 TASK PAUSED\n\nSTOP all work immediately.\nDO NOT attempt further solutions.\nWait for PM instructions."
)
```

### 2️⃣ 收集上下文
- 进度百分比
- 已完成产出
- 具体错误信息
- 已尝试的方案及结果

### 3️⃣ 更新状态文件
`projects/{id}/agent-status.json`
```json
{
  "status": "PAUSED",
  "pausedAt": "2026-02-01T04:30:00Z",
  "reason": "...",
  "progress": "35%",
  "attemptedSolutions": [...]
}
```

### 4️⃣ 详细汇报用户

**必须包含**:
- 子智能体信息（名称/角色/运行时长）
- 问题详细描述（类型/错误/时间）
- 已尝试的方案清单
- 当前进度和阻塞点
- 影响评估（对项目的影响/延误）
- 3个可行方案（A/B/C）+ 优缺点
- 我的建议及理由

## 用户决策后的恢复流程

1. **解析决策** → 选项/资源/约束
2. **更新状态** → status: "RESUMING"
3. **准备任务** → 包含历史上下文+用户决策
4. **重新启动** → sessions_spawn(adjusted_task)
5. **加强监控** → 每10分钟检查

## 强制暂停触发器（10种）

| 触发条件 | 状态 |
|---------|------|
| 工具不可用 | 🛑 PAUSE |
| API/服务限制 | 🛑 PAUSE |
| 权限被拒绝 | 🛑 PAUSE |
| 需要用户文件/数据 | 🛑 PAUSE |
| 需求不明确 | 🛑 PAUSE |
| 技术限制 | 🛑 PAUSE |
| 范围需要重大变更 | 🛑 PAUSE |
| 团队分歧>2轮 | 🛑 PAUSE |
| 多次失败(>2次) | 🛑 PAUSE |
| 预算/使用问题 | 🛑 PAUSE |

## 黄金法则

```
❌ 不要："让我看看能不能帮你解决"
❌ 不要：让其他子智能体"帮忙完成"
❌ 不要：假设用户想要什么

✅ 必须：立即停止该子智能体
✅ 必须：详细汇报用户
✅ 必须：等待明确决策后再恢复
```

## 汇报模板结构

```
🛑 子智能体任务暂停 —— 需要您的决策

【暂停子智能体信息】
【问题详细描述】
【已尝试的解决方案】
【当前进度】
【影响评估】
【可行方案】A / B / C
【我的建议】

请回复：1.选择方案 2.提供资源 3.新方案 4.终止任务
```

## 恢复任务模板

```
你是一个{role}，之前因{reason}暂停的任务现在恢复。

【历史上下文】
原任务: {...}
已完成: {...}
进度: {X}%

【之前遇到的问题】
{...}

【用户决策】
选择: {option}
提供资源: {...}

【调整后的任务】
{...}

【特别说明】
⚠️ 基于之前进度继续，不要从头开始
⚠️ 避免重复之前失败的方案
⚠️ 再次遇到问题立即汇报，不要自行尝试超过2次
```

## 常见错误（避免）

| ❌ 错误 | ✅ 正确 |
|--------|--------|
| "让我帮你看看其他方案" | "停止工作，我立即汇报用户" |
| "设计师你能帮忙收集数据吗？" | "研究员已暂停，等待用户提供数据源" |
| "需要API key，请提供" | 使用完整汇报模板 |
| "用户没说什么，继续试试" | "用户未给出明确指示，保持暂停" |

## 自我检查（汇报前）

- [ ] 已停止子智能体？
- [ ] 收集了完整上下文？
- [ ] 汇报足够详细？
- [ ] 提供了可行选项？
- [ ] 给出了诚实建议？
- [ ] 准备等待用户决策？

---

*详细检查清单见: PM_CHECKLIST.md*
